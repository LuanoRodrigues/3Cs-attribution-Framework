/* insert.css — Insert tab styling (full replacement)
   Keeps existing group/cluster map but layers a Home-like chrome:
   two button rows, a footer/title row, and consistent Fluent-styled cards.
*/

/* =========================
   Insert tab scoping
   ========================= */
.leditor-ribbon-panel[data-tab-id="insert"] {
  --insert-cluster-gap: 10px;
  --insert-row-height: var(--home-row-height, 34px);
  --insert-group-pad-y: 8px;
  --insert-group-pad-x: 12px;
  --insert-group-bg: linear-gradient(180deg, #ffffff 0%, #f5f5f7 100%);
  --insert-group-border: rgba(15, 23, 42, 0.12);
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-groups {
  flex-wrap: nowrap;
  overflow-x: auto;
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-group {
  background: var(--insert-group-bg);
  border: 1px solid var(--insert-group-border);
  border-radius: 4px;
  padding: var(--insert-group-pad-y) var(--insert-group-pad-x);
  min-width: 200px;
  display: flex;
  flex-direction: column;
  gap: var(--insert-cluster-gap);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.9);
  min-height: calc(var(--insert-row-height) * 2 + var(--insert-group-pad-y));
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-group-body {
  display: grid;
  grid-template-rows: var(--insert-row-height) var(--insert-row-height);
  row-gap: 0;
  overflow: visible;
  max-height: none;
  flex: 1;
  padding-bottom: 0;
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-group-row {
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: var(--insert-row-height);
  gap: var(--insert-cluster-gap);
  align-items: center;
  justify-content: flex-start;
  overflow: visible;
  height: var(--insert-row-height);
  min-height: var(--insert-row-height);
  grid-row: 1;
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-group-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: auto;
  padding-top: 6px;
  border-top: 1px solid rgba(15, 23, 42, 0.08);
  font-size: var(--r-font-size-sm);
  color: var(--r-muted);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  font-weight: 600;
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-group-title {
  text-align: center;
  width: 100%;
  letter-spacing: 0.01em;
}

.leditor-ribbon-panel[data-tab-id="insert"] .leditor-ribbon-group-footer {
  position: relative;
  justify-content: center;
}

.leditor-ribbon-panel[data-tab-id="insert"] .ribbon-dialog-launcher-btn {
  position: absolute;
  right: 4px;
  top: 2px;
  border: none;
  background: none;
  padding: 0;
}

.leditor-ribbon-panel[data-tab-id="insert"] .ribbon-cluster {
  display: inline-flex;
  flex-wrap: nowrap;
  gap: var(--insert-cluster-gap);
  align-items: center;
  justify-content: flex-start;
  min-width: 0;
}

.leditor-ribbon-panel[data-tab-id="insert"] .ribbon-button-label {
  display: none;
}

.leditor-ribbon-panel[data-tab-id="insert"] .ribbon-cluster > .leditor-ribbon-button,
.leditor-ribbon-panel[data-tab-id="insert"] .ribbon-cluster > .leditor-ribbon-icon-btn {
  width: var(--insert-row-height);
  height: var(--insert-row-height);
  min-width: var(--insert-row-height);
  line-height: 1;
  border-radius: 6px;
  background: transparent;
  border: none;
  color: var(--r-text);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: var(--fluent-icon-font);
}

/* =========================
   Pages group
   ========================= */
/* Pages.primary is a column of large controls */
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="pages"] [data-cluster-id="pages.primary"],
.leditor-ribbon-panel[data-tab-id="insert"] [data-cluster-id="pages.primary"] {
  display: grid;
  grid-auto-flow: row;
  gap: var(--insert-cluster-gap);
  align-content: start;
}

.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="pages"] .leditor-split-button,
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="pages"] .leditor-ribbon-button--large {
  width: 110px;
}

/* =========================
   Tables group
   ========================= */
/* Tables.primary is a column; main control is splitButton(Table) large, plus an optional quickTablesStandalone */
.leditor-ribbon-panel[data-tab-id="insert"] [data-cluster-id="tables.primary"] {
  display: grid;
  grid-auto-flow: row;
  gap: var(--insert-cluster-gap);
  align-content: start;
}

.leditor-ribbon-panel[data-tab-id="insert"] [data-control-id="tables.insertTable"],
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="tables"] .leditor-split-button {
  width: 110px;
}

/* Table grid picker widget (menu surface) — aligns with ribbon.css pickers */
.leditor-ribbon-panel[data-tab-id="insert"] .rtablePicker {
  width: 260px;
}

/* Ensure custom widget entry looks like a menu row */
.leditor-ribbon-panel[data-tab-id="insert"] [data-control-id="tables.gridPicker"] {
  padding: 6px 8px;
}

/* =========================
   Illustrations group
   ========================= */
/* Wide row of large controls; keep nowrap but allow scroll */
.leditor-ribbon-panel[data-tab-id="insert"] [data-cluster-id="illustrations.primary"] {
  display: flex;
  align-items: flex-start;
  gap: var(--insert-cluster-gap);
  flex-wrap: nowrap;
  overflow-x: auto;
  padding-bottom: 2px;
}

/* Harmonize large tiles */
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="illustrations"] .leditor-ribbon-button--large,
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="illustrations"] .leditor-split-button {
  width: 118px;
}

.leditor-ribbon-panel[data-tab-id="insert"] .rembed {
  width: 520px;
  background: var(--r-surface);
  border: 1px solid var(--r-border-color);
  border-radius: 4px;
  box-shadow: var(--r-shadow);
  padding: 12px;
}

.leditor-ribbon-panel[data-tab-id="insert"] .rembed textarea {
  width: 100%;
  height: 160px;
  border: 1px solid var(--r-border-color);
  border-radius: 3px;
  padding: 10px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 12px;
  background: #ffffff;
  color: var(--r-text);
}

/* =========================
   Links group
   ========================= */
.leditor-ribbon-panel[data-tab-id="insert"] [data-cluster-id="links.primary"] {
  display: flex;
  align-items: flex-start;
  gap: var(--insert-cluster-gap);
  flex-wrap: nowrap;
}

.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="links"] .leditor-ribbon-button--medium,
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="links"] .leditor-split-button {
  width: 120px;
}

/* When collapsed into menus, keep split buttons from shrinking too much */
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="links"] .leditor-split-button {
  min-width: 108px;
}

/* =========================
  Symbols group
   ========================= */
.leditor-ribbon-panel[data-tab-id="insert"] [data-cluster-id="symbols.primary"] {
  display: flex;
  gap: var(--insert-cluster-gap);
  align-items: flex-start;
  flex-wrap: nowrap;
}

.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="symbols"] .leditor-ribbon-button--large,
.leditor-ribbon-panel[data-tab-id="insert"] [data-group-id="symbols"] .leditor-split-button {
  width: 118px;
}

.leditor-ribbon-panel[data-tab-id="insert"] [data-control-id="symbols.emoji"] {
  min-width: 96px;
}

/* =========================
   Galleries used by Insert
   ========================= */
/* Cover pages / Shapes / Equations galleries — reuse existing rgallery styles but ensure sizing */
.leditor-ribbon-panel[data-tab-id="insert"] .rgallery {
  width: 360px;
}

.leditor-ribbon-panel[data-tab-id="insert"] .rgallery__grid {
  grid-template-columns: repeat(3, 1fr);
}

/* Make gallery items look “template-like” */
.leditor-ribbon-panel[data-tab-id="insert"] .rgallery__item {
  min-height: 78px;
}

/* =========================
   Stage B/C behavior
   ========================= */
/* Insert already uses nowrap + overflow; Stage B adds more consolidation but keep it usable */
.leditor-ribbon-panel[data-tab-id="insert"][data-stage="B"] .leditor-ribbon-group {
  min-width: 180px;
}

.leditor-ribbon-panel[data-tab-id="insert"][data-stage="C"] .leditor-ribbon-group-body {
  overflow: hidden;
}

/* =========================
   Optional: data-attribute fallbacks
   If your renderer does not set data-group-id/data-cluster-id, these class hooks
   help align with earlier ribbon.css conventions.
   ========================= */
.leditor-ribbon-panel[data-tab-id="insert"] .ribbon-page-setup {
  height: 100%;
}
